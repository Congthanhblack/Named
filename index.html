<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HPH-SOC // TRUNG TÂM GIÁM SÁT ĐIỀU HÀNH THÔNG MINH</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;500&family=Noto+Serif:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <style>
        body { background-color: #050505; color: #e2e8f0; font-family: 'Inter', sans-serif; overflow: hidden; height: 100vh; width: 100vw; }
        .cyber-border { border: 1px solid #1f1f23; background: rgba(10, 10, 12, 0.95); }
        .mono-text { font-family: 'JetBrains Mono', monospace; }
        .draggable-window { position: absolute; z-index: 1000; box-shadow: 0 25px 60px rgba(0,0,0,0.9); display: none; }
        .drag-handle { cursor: move; user-select: none; }
        .gov-paper { background: #fff; color: #000; font-family: 'Noto Serif', serif; width: 780px; padding: 40px; border: 2px solid #000; }
        .small-alert { background: #0a0a0c; color: #fff; width: 420px; border: 1px solid #2563eb; padding: 20px; box-shadow: 0 0 20px rgba(37, 99, 235, 0.2); }
        .online-dot { animation: pulse-green 2s infinite; }
        @keyframes pulse-green { 0%, 100% { opacity: 1; } 50% { opacity: 0.2; } }
        .cam-slot { position: relative; background: #000; border: 1px solid #18181b; aspect-ratio: 16 / 9; overflow: hidden; }
        .cam-error-overlay { background: linear-gradient(rgba(15, 0, 0, 0.9) 50%, rgba(0, 0, 0, 1) 50%); background-size: 100% 4px; animation: scanline 0.25s linear infinite; }
        @keyframes scanline { 0% { background-position: 0 0; } 100% { background-position: 0 4px; } }
        .tab-btn { background: #131316; border: 1px solid #27272a; color: #71717a; font-size: 11px; font-weight: 700; }
        .tab-btn.active { background: #2563eb; color: #fff; border-color: #60a5fa; }
        .recovery-counter { background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); padding: 4px 12px; border-radius: 4px; }
        .login-bg { background: radial-gradient(circle at center, #1e293b 0%, #020617 100%); }
    </style>
</head>
<body class="flex flex-col h-full select-none">

    <div id="login-layer" class="fixed inset-0 z-[2000] flex items-center justify-center login-bg">
        <div class="relative w-[480px] space-y-6">
            <div class="flex flex-col items-center mb-8">
                <img src="https://upload.wikimedia.org/wikipedia/commons/a/af/Vietnam_Coat_of_Arms.svg" class="h-20 mb-4">
                <h1 class="text-white text-lg font-bold tracking-[0.2em] uppercase text-center">Hệ Thống Thông Tin Điều Hành IOC</h1>
                <p class="text-blue-400 text-[10px] tracking-[0.3em] font-medium uppercase mt-2">Cổng xác thực tập trung - Thành phố Hải Phòng</p>
            </div>
            <div class="cyber-border p-8 rounded-none border-t-2 border-t-blue-500 relative bg-[#0f172a]/95 backdrop-blur-xl">
                <div class="space-y-6">
                    <div>
                        <label class="block text-[10px] text-slate-500 font-bold uppercase mb-2 tracking-widest">Mã định danh vận hành</label>
                        <input type="text" value="ADMIN_IOC_HPH" disabled class="w-full bg-black/50 border border-slate-800 p-3 text-xs text-slate-400 outline-none rounded">
                    </div>
                    <div>
                        <label class="block text-[10px] text-slate-500 font-bold uppercase mb-2 tracking-widest">Khóa bảo mật</label>
                        <input type="password" id="login-pass" class="w-full bg-black border border-slate-700 p-3 text-sm text-white outline-none focus:border-blue-500 rounded" placeholder="••••••••" onkeypress="if(event.key === 'Enter') handleLogin()">
                    </div>
                    <button onclick="handleLogin()" class="w-full bg-blue-700 hover:bg-blue-600 text-white font-bold py-4 text-[11px] uppercase tracking-[0.2em] rounded transition-all">Xác thực truy cập</button>
                    <p id="login-err" class="text-[10px] text-red-500 text-center h-2 uppercase font-bold tracking-widest"></p>
                </div>
            </div>
        </div>
    </div>

    <div id="main-dashboard" class="hidden flex flex-col h-full p-1 gap-1">
        <header class="h-16 shrink-0 cyber-border flex items-center justify-between px-6">
            <div class="flex items-center gap-6">
                <img src="https://upload.wikimedia.org/wikipedia/commons/a/af/Vietnam_Coat_of_Arms.svg" class="h-12">
                <div class="border-l border-slate-800 pl-6">
                    <h1 class="text-[16px] font-black text-white uppercase tracking-tight italic">IOC HẢI PHÒNG - NETWORK RECOVERY MODE</h1>
                    <div class="flex items-center gap-4 text-[10px] mt-1">
                        <span id="system-date" class="text-slate-500 font-bold">06-02-2026</span>
                        <div class="flex items-center gap-1.5 recovery-counter">
                            <span class="text-emerald-500 font-black uppercase tracking-tighter">CCTV RECOVERED: </span>
                            <span id="cctv-count" class="text-white font-black mono-text tracking-normal">0/0</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex items-center gap-10">
                <div id="system-clock" class="text-3xl mono-text text-white font-medium tracking-tighter">00:00:00</div>
                <div class="text-right border-l border-slate-800 pl-10">
                    <div class="text-[9px] text-slate-500 font-bold uppercase tracking-widest">Session</div>
                    <div id="session-timer" class="text-xl mono-text text-blue-500 font-bold">30:00</div>
                </div>
            </div>
        </header>

        <div class="flex-1 flex gap-1 overflow-hidden min-h-0">
            <div class="w-[420px] flex flex-col gap-1 shrink-0 h-full">
                <div class="flex-1 cyber-border flex flex-col overflow-hidden">
                    <div class="bg-slate-900/30 p-4 border-b border-slate-800 flex justify-between items-center">
                        <h3 class="text-[11px] font-black text-blue-400 uppercase tracking-widest">Real-time Traffic Logs</h3>
                    </div>
                    <div id="log-box" class="flex-1 overflow-y-auto p-3 text-[11px] space-y-3 mono-text"></div>
                </div>
                <div id="terminal-screen" class="h-[150px] cyber-border p-4 text-[10px] mono-text text-emerald-500/70 overflow-y-auto bg-black">
                    <div>> AI Recognition Engine: LOADED</div>
                    <div>> Rebuilding Network Nodes...</div>
                </div>
            </div>
            <div class="flex-1 flex flex-col gap-1">
                <div class="h-12 cyber-border flex items-center px-1 gap-1">
                    <button class="tab-btn active flex-1 h-full" onclick="switchTab('ALL', this)">NETWORK TOPOLOGY</button>
                    <button class="tab-btn flex-1 h-full" onclick="switchTab('CORE', this)">VÙNG NỘI ĐÔ</button>
                </div>
                <div id="camera-grid" class="flex-1 grid grid-cols-4 grid-rows-3 gap-2 p-1 cyber-border"></div>
            </div>
        </div>
    </div>

    <div id="gov-window" class="draggable-window">
        <div class="gov-paper">
            <div class="drag-handle">
                <div class="flex justify-between items-start text-[9px] font-bold uppercase">
                    <div class="text-left">
                        <p>UBND THÀNH PHỐ HẢI PHÒNG</p>
                        <p class="text-red-700 underline underline-offset-4 decoration-1">Sở Thông tin và Truyền thông</p>
                    </div>
                    <div class="text-center">
                        <p>CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</p>
                        <p class="underline underline-offset-4 decoration-1">Độc lập - Tự do - Hạnh phúc</p>
                    </div>
                </div>
                <div class="h-[1.5px] bg-black w-full my-6"></div>
                <h2 class="text-2xl font-bold text-red-700 uppercase tracking-[0.2em] text-center mb-8">Lệnh truy xuất dữ liệu khẩn cấp</h2>
            </div>
            <div class="text-[14px] space-y-4 mb-8 leading-relaxed">
                <p>Mã thiết bị: <span class="mono-text text-red-700 font-bold" id="alert-cam-id"></span>.</p>
                <p><strong>Điểm giám sát:</strong> <span class="uppercase font-bold" id="alert-cam-name"></span></p>
                <p><strong>Vị trí:</strong> <span class="italic underline text-blue-900" id="alert-address"></span></p>
                <p class="text-justify border-t border-black pt-4">Dữ liệu tại vị trí này đang tạm thời ngắt kết nối để bảo trì Server. Mọi hành động truy cập không hợp lệ đã được ghi lại.</p>
            </div>
            <div class="grid grid-cols-2 border-t border-black pt-6 text-[11px]">
                <div>
                    <p class="font-bold uppercase text-red-800 mb-1">Đơn vị quản lý:</p>
                    <p>Địa chỉ: Số 62 Võ Thị Sáu, Ngô Quyền, Hải Phòng</p>
                    <p>Hotline: 0225.3736.333</p>
                </div>
                <div class="text-right italic">Hải Phòng, ngày 06/02/2026</div>
            </div>
            <div class="flex justify-center mt-10"><button onclick="closeWindow('gov-window')" class="px-12 py-2.5 border-2 border-black font-black text-[11px] uppercase">Đóng văn bản</button></div>
        </div>
    </div>

    <div id="denied-window" class="draggable-window">
        <div class="small-alert">
            <div class="drag-handle flex justify-between items-center mb-5 border-b border-blue-900/50 pb-3">
                <span class="text-[10px] font-black text-blue-500 uppercase tracking-widest"><i class="fas fa-fingerprint mr-2"></i> Access Denied</span>
                <button onclick="closeWindow('denied-window')" class="text-slate-600 hover:text-white"><i class="fas fa-times"></i></button>
            </div>
            <div class="space-y-4">
                <p class="text-xs font-black text-white uppercase" id="denied-cam-name"></p>
                <p class="text-[11px] text-slate-400 italic">"Địa chỉ User này không được cấp quyền hạn xem trực tiếp luồng dữ liệu giải mã. Hãy liên hệ với quản trị viên để yêu cầu nâng cấp quyền hạn Level 4."</p>
                <div class="pt-3 flex justify-end"><button onclick="closeWindow('denied-window')" class="bg-blue-600 text-white text-[9px] px-6 py-1.5 font-black uppercase tracking-widest">Xác nhận</button></div>
            </div>
        </div>
    </div>

    <script>
        const cameraData = [
            { id: "CAM-HP-001", name: "CẦU BÍNH", addr: "Số 1 đường Bạch Đằng, P. Thượng Lý, Q. Hồng Bàng, Hải Phòng", cat: "CORE", status: "CONNECTED" },
            { id: "CAM-HP-002", name: "NHÀ HÁT LỚN", addr: "Số 28 phố Quang Trung, P. Hoàng Văn Thụ, Q. Hồng Bàng, Hải Phòng", cat: "CORE", status: "CONNECTED" },
            { id: "CAM-HP-003", name: "NGÃ 6 LẠCH TRAY", addr: "Giao lộ Lạch Tray - Q. Ngô Quyền, Hải Phòng", cat: "CORE", status: "LOST" },
            { id: "CAM-HP-004", name: "CẦU RÀO 2", addr: "Đường Võ Nguyên Giáp, P. Vĩnh Niệm, Q. Lê Chân, Hải Phòng", cat: "CORE", status: "LOST" },
            { id: "CAM-HP-005", name: "NÚI ĐÈO", addr: "Thị trấn Núi Đèo, huyện Thủy Nguyên, Hải Phòng", cat: "SUBURB", status: "LOST" },
            { id: "CAM-HP-006", name: "T.T AN DƯƠNG", addr: "Đường 351, huyện An Dương, Hải Phòng", cat: "SUBURB", status: "LOST" },
            { id: "CAM-HP-007", name: "CẦU KHUỂ", addr: "Tỉnh lộ 354, huyện An Lão, Hải Phòng", cat: "SUBURB", status: "LOST" },
            { id: "CAM-HP-008", name: "T.T TIÊN LÃNG", addr: "Khu phố huyện, huyện Tiên Lãng, Hải Phòng", cat: "SUBURB", status: "LOST" },
            { id: "CAM-HP-009", name: "CẢNG ĐÌNH VŨ", addr: "Khu kinh tế Đình Vũ, Q. Hải An, Hải Phòng", cat: "PORT", status: "LOST" },
            { id: "CAM-HP-010", name: "KCN VSIP", addr: "Xã Tân Dương, huyện Thủy Nguyên, Hải Phòng", cat: "PORT", status: "LOST" },
            { id: "CAM-HP-011", name: "CẢNG LẠCH HUYỆN", addr: "Đảo Cát Hải, huyện Cát Hải, Hải Phòng", cat: "PORT", status: "LOST" },
            { id: "CAM-HP-012", name: "KDL ĐỒ SƠN", addr: "Khu 2, Vạn Hương, Q. Đồ Sơn, Hải Phòng", cat: "PORT", status: "LOST" }
        ];

        const usedPlates = new Set();
        const vehicleModels = ["VinFast VF8", "Toyota Camry", "Honda CR-V", "Hyundai SantaFe", "Mercedes E300", "Mazda CX-5"];
        const violations = ["Vượt đèn đỏ", "Chạy quá tốc độ (>60km/h)", "Đi sai làn đường", "Ngược chiều"];

        function updateCCTVCounter() {
            const total = cameraData.length;
            const connected = cameraData.filter(c => c.status === "CONNECTED").length;
            document.getElementById('cctv-count').innerText = `${connected}/${total}`;
        }

        // THUẬT TOÁN NHẢY SỐ (RECOVERY SIMULATION)
        function simulateRecovery() {
            const lostCams = cameraData.filter(c => c.status === "LOST");
            if(lostCams.length > 0) {
                const target = lostCams[Math.floor(Math.random() * lostCams.length)];
                target.status = "CONNECTED";
                createCameraGrid();
                addLog(`<span class="text-emerald-500 font-bold">[RECOVERY]</span> Node ${target.id} (${target.name}) restored successfully.`, 'info');
                const term = document.getElementById('terminal-screen');
                const div = document.createElement('div');
                div.innerText = `> Handshake established: ${target.id} ... OK`;
                term.appendChild(div); term.scrollTop = term.scrollHeight;
            }
            setTimeout(simulateRecovery, Math.random() * 20000 + 40000); // 40-60 giây nhảy 1 lần
        }

        function createCameraGrid() {
            const grid = document.getElementById('camera-grid'); grid.innerHTML = '';
            cameraData.forEach(cam => {
                const div = document.createElement('div');
                div.className = "cam-slot group cursor-pointer flex flex-col items-center justify-center";
                if(cam.status === "CONNECTED") {
                    div.innerHTML = `<div class="absolute top-2 left-2 z-10 text-[9px] text-emerald-400 font-black tracking-widest"><i class="fas fa-circle online-dot mr-1 text-[7px]"></i> ${cam.id}</div>
                                     <div class="text-emerald-500/10 text-3xl font-black italic">ACTIVE</div>`;
                    div.onclick = () => showDenied(cam);
                } else {
                    div.className += " cam-error-overlay";
                    div.innerHTML = `<div class="absolute top-2 left-2 z-10 text-[9px] text-white/30 font-bold">${cam.id}</div>
                                     <i class="fas fa-unlink text-red-900/30 text-3xl"></i>
                                     <span class="text-[9px] text-red-900 font-black uppercase mt-2">Offline</span>`;
                    div.onclick = () => showGov(cam);
                }
                grid.appendChild(div);
            });
            updateCCTVCounter();
        }

        function generateUniquePlate() {
            let plate;
            do { plate = `15A-${Math.floor(10000 + Math.random() * 89999)}`; } while (usedPlates.has(plate));
            usedPlates.add(plate); return plate;
        }

        function startViolationStream() {
            setTimeout(() => {
                const cam = cameraData.filter(c => c.status === "CONNECTED")[Math.floor(Math.random() * cameraData.filter(c => c.status === "CONNECTED").length)];
                if(!cam) { startViolationStream(); return; }
                const plate = generateUniquePlate();
                const car = vehicleModels[Math.floor(Math.random() * vehicleModels.length)];
                const vio = violations[Math.floor(Math.random() * violations.length)];
                addLog(`
                    <div class="p-2 border-l-2 border-red-600 bg-red-950/10 mb-2">
                        <div class="flex justify-between font-black text-[9px] text-red-500 mb-1"><span>[DETECTED]</span><span>PENDING</span></div>
                        <div class="text-white text-[10px] font-bold">BKS: ${plate}</div>
                        <div class="text-slate-400 text-[10px]">${car} • ${vio}</div>
                        <div class="text-slate-500 text-[9px] mt-1 italic">${cam.name}</div>
                    </div>
                `);
                startViolationStream();
            }, 35000);
        }

        function showGov(cam) {
            const win = document.getElementById('gov-window');
            document.getElementById('alert-cam-id').innerText = cam.id;
            document.getElementById('alert-cam-name').innerText = cam.name;
            document.getElementById('alert-address').innerText = cam.addr;
            win.style.display = 'block'; win.style.top = '15%'; win.style.left = '25%';
        }

        function showDenied(cam) {
            const win = document.getElementById('denied-window');
            document.getElementById('denied-cam-name').innerText = cam.name;
            win.style.display = 'block'; win.style.top = '30%'; win.style.left = '35%';
        }

        function closeWindow(id) { document.getElementById(id).style.display = 'none'; }

        // KÉO THẢ
        document.querySelectorAll('.draggable-window').forEach(win => {
            const handle = win.querySelector('.drag-handle');
            let isDragging = false, offsetX, offsetY;
            handle.onmousedown = (e) => {
                isDragging = true;
                offsetX = e.clientX - win.offsetLeft;
                offsetY = e.clientY - win.offsetTop;
            };
            document.onmousemove = (e) => {
                if (isDragging) {
                    win.style.left = (e.clientX - offsetX) + 'px';
                    win.style.top = (e.clientY - offsetY) + 'px';
                }
            };
            document.onmouseup = () => isDragging = false;
        });

        function handleLogin() {
            const pass = document.getElementById('login-pass').value.trim();
            if(pass.length > 0){
                document.getElementById('login-layer').style.display = 'none';
                document.getElementById('main-dashboard').classList.remove('hidden');
                createCameraGrid(); 
                startViolationStream(); 
                simulateRecovery();
                setInterval(() => {
                    const now = new Date();
                    document.getElementById('system-clock').innerText = now.toLocaleTimeString('vi-VN', { hour12: false });
                    document.getElementById('system-date').innerText = now.toLocaleDateString('vi-VN').split('/').join('-');
                }, 1000);
            } else {
                document.getElementById('login-err').innerText = "VUI LÒNG NHẬP KHÓA XÁC THỰC.";
            }
        }

        function addLog(msg) {
            const box = document.getElementById('log-box');
            const div = document.createElement('div');
            const time = new Date().toLocaleTimeString('vi-VN', {hour12: false});
            div.innerHTML = `<span class="text-slate-600">[${time}]</span> ${msg}`;
            box.prepend(div);
        }
    </script>
</body>
</html>
